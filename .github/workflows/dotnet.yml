name: .NET CI

on: ["push", "pull_request"]

jobs:
    build:
        runs-on: windows-latest
        name: Build
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Setup .NET Core
              uses: actions/setup-dotnet@v3.2.0
              with:
                  dotnet-version: "8.0"

            - name: Publish Application
              env:
                  runtime: win-x64
              working-directory: ./StudentInformationSheet
              run: |
                  $options=@("--configuration", "Release", "-p:PublishSingleFile=true", "-p:DebugType=embedded", "--no-self-contained", "-p:SourceRevisionId=$(git rev-parse --short HEAD)")
                  dotnet publish StudentInformationSheet $options --runtime $ENV:runtime -o build/$ENV:runtime

            - name: Upload Windows artifacts
              uses: actions/upload-artifact@v3.1.3
              with:
                  name: StudentInformationSheet win-x64
                  path: ./StudentInformationSheet/StudentInformationSheet/build/win-x64
